<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Nodepop - Gabi Lago Blasco</title>

    <!-- Bootstrap core CSS -->
    <link href="stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet">
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="stylesheets/resume.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
      <a class="navbar-brand js-scroll-trigger" href="#page-top">
        <span class="d-block d-lg-none">Nodepop</span>
        <span class="d-none d-lg-block">
          <img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="images/goku.gif" alt="">
        </span>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#quick">Quick Start</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#VERSIONS_22">Versions</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#REQUIREMENTS_AND_DEPENDENCIES_32">Requirements</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#INSTALLING_56">Installing</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#Starting_the_API_89">Starting API</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#API_USE_109">API Use</a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid p-0">

      <section class="resume-section p-3 p-lg-5 d-flex d-column" id="about">
        <div class="my-auto">
          <h1 class="mb-0">This is not a
            <span class="text-primary">Website</span>
          </h1>
          <div class="subheading mb-5">it´s a rest node API
          </div>
          <p class="lead mb-5"><strong>Nodepop</strong> is an API for a 2nd hand articles App developed in NodeJS + Express4 + Mongoose
          <br />This is a Practice Exercise for <strong>KeepCoding Mobile Bootcamp 8</strong> - Node Fundamentals Module</p>
          
        </div>
      </section>

      <hr class="m-0">

      <section class="resume-section p-3 p-lg-5 d-flex flex-column" id="experience">
        
        <h2><a id="quick"></a>Quick Start</h2> 
        <p>This demo has already loaded some sample data on its database.</p>

        <p>You´ll need to do some POST andGET requests to the app. A tool like Postman or Insomnia could be helpeful.</p>
        <p>In addition to the POST or GET values of the request, you´ll need to set a header for Content-Type with the value 'application/x-www-form-urlencoded'.</p>
        <p>You can also change the language for error reporting with the header Accept-Language. Values accepted are 'es' for spanish an 'en' for english.</p>
        <hr class="m-0"><br />
        <h3>Users</h3>
        <h4>Login</h4>
        <p>In order to send a request to the API, you need to be authenticated. You can use the default user, adding this fields to the POST:</p>
        <ul>
          <li><strong>email: </strong> admin@example.org</li>
          <li><strong>password: </strong> 1234</li>
        </ul>
        <p><strong>POST URL: </strong><a href="">https://nodepop.lagoblasco.es/api/usuarios/login</a></p>
        <p>If the login is succesful, the API will respond with a JSON array where you´ll find the token needed to further access the API</p>
        <h4>Register</h4>
        <p>Additionally you can register as many users as you want</p>
        <p><strong>POST URL: </strong><a href="#">https://nodepop.lagoblasco.es/api/usuarios/registro</a></p>
        <hr class="m-0"><br />
        <h3>Adds</h3>
        <h4>List</h4>
        <p>You can get a list of every add loaded in the database sending a GET request to:</p>
        <p><strong>GET URL: </strong><a href="#">https://nodepop.lagoblasco.es/api/anuncios?jwttoken=YOUR_TOKEN</a></p>
        <p>jwttoken value should be fulfilled with the token got on the login to get a valid response</p>
        <h4>Filters</h4>
        <p>You can use all or some of the filters you see on the followin URL, more info provided below.</p>
        <p><strong>POST URL: </strong><a a href="#">https://nodepop.lagoblasco.es/api/anuncios?tag=mobile&amp;venta=false&amp;nombre=Bicl&amp;precio=50­-&amp;skip=0&amp;limit=2&amp;sort=precio&amp;jwttoken=YOUR_TOKEN</a></p>

        <h4>Tags</h4>
        <p><strong>POST URL: </strong><a href="#">https://nodepop.lagoblasco.es/apiv1/anuncios/tags&amp;jwttoken=YOUR_TOKEN</a></p>
       
        <hr class="m-0">
        <h2><a id="VERSIONS_22"></a>VERSIONS</h2>
        <p>This the 2nd version of the app (you can acess v1 on its branch in github)<br>
        It includes some refactoring thanks to the advices given by Javier Miguel when he reviewed the practice.</p>
        <ul>
        <li>The mongo connection chain is now an env variable you can define on your .env configuration file</li>
        <li>Some middlewares that didn´t catch errors has been refactored with try/cathc</li>
        <li>The sample instalation script has been refactored as a function that returns a promise.</li>
        </ul>
        <hr class="m-0">
        <h2><a id="REQUIREMENTS_AND_DEPENDENCIES_32"></a>REQUIREMENTS AND DEPENDENCIES</h2>
        <p>The API has been built using NodeJS Express framework and MongoDB through Mongoose ODM.</p>
        <p>It needs NodeJS ^10.0.0 and MongoDB ^4.0.0 properly installed and running.</p>
        <p>Fork the project and the following dependencies will be installed after running:</p>
        <pre><code class="language-shell">npm install
        </code></pre>
        <ul>
        <li><strong>express</strong>: ~4.16.0</li>
        <li><strong>mongoose</strong>: ^5.3.16</li>
        <li><strong>bcrypt</strong>: ^3.0.2</li>
        <li><strong>cookie-parser</strong>: ~1.4.3</li>
        <li><strong>cross-env</strong>: ^5.2.0</li>
        <li><strong>debug</strong>: ~2.6.9</li>
        <li><strong>dotenv</strong>: ^6.2.0</li>
        <li><strong>ejs</strong>: ~2.5.7</li>
        <li><strong>http-errors</strong>: ~1.6.2</li>
        <li><strong>i18n</strong>: ^0.8.3</li>
        <li><strong>jsonwebtoken</strong>: ^8.4.0</li>
        <li><strong>morgan</strong>: “~1.9.0”</li>
        </ul>
        <hr class="m-0">
        <h2><a id="INSTALLING_56"></a>INSTALLING</h2>
        <p>There are two steps needed before running the app:</p>
        <ul>
        <li>
        <h3><a id="Database_intializing_script_59"></a>Database intializing script</h3>
        </li>
        </ul>
        <pre><code class="language-shell">npm run installDB
        </code></pre>
        <p>It adds some sample data to the Ads database collection and a test user to the User collection.</p>
        <ul>
        <li>
        <h3><a id="Configuration_file_66"></a>Configuration file</h3>
        </li>
        </ul>
        <p>A file containing environment variables is needed.<br>
        A .env.example file is provided.<br>
        Just duplicated it and renamed as .env</p>
        <pre><code class="language-shell">cp .env.example .env
        </code></pre>
        <p>Change the values for the Authentication Token Module:</p>
        <p><strong>JWT_SECRET</strong>: A String of characters that allows jsonwebtoken to generate the Token</p>
        <p><strong>JWT_EXPIRATION</strong>: 2d</p>
        <p>And for the test user that will be created in the installation process</p>
        <p><strong>TEST_NAME</strong> = name</p>
        <p><strong>TEST_EMAIL</strong> = email</p>
        <p><strong>TEST_PASSWD</strong> =  password</p>
        <h2><a id="Starting_the_API_89"></a>Starting the API</h2>
        <p>There are three starting modes:</p>
        <p><strong>Production:</strong></p>
        <pre><code class="language-shell">npm run start
        </code></pre>
        <p><strong>Dev</strong> DEBUG mode</p>
        <pre><code class="language-shell">npm run dev
        </code></pre>
        <p><strong>Cluster</strong> For better performance in multiple connections. It starts the app using as many workers as threads the CPU allows.</p>
        <pre><code class="language-shell">npm run cluster
        </code></pre>
        <hr class="m-0">
        <h2><a id="API_USE_109"></a>API USE</h2>
        <p>The API will send a response with a JSON object for prorperly formatted requests.</p>
        <h3><a id="USERS_113"></a>USERS</h3>
        <p>Only authenticated users requests will be responded by the API.</p>
        <p>A valid token, needed for any <code>GET</code> request, will be provided as a response after a successful login.<br>
        <em>Token expiring time is set by default as 2 days, you can change it in <code>.env</code> file</em></p>
        <h4><a id="Register_118"></a>Register</h4>
        <p>The API provides a register method</p>
        <p><strong>URL</strong></p>
        <p><code>http://[server_domain]/apiv1/usuarios/registro</code></p>
        <p><strong>Method</strong></p>
        <p>| <code>POST</code> | application/x-www-form-urlencoded</p>
        <p>Values must be provided for the following keys:</p>
        <pre><code>nombre
        email
        password
        </code></pre>
        <ul>
        <li>
        <p><strong>Success Response:</strong></p>
        <ul>
        <li><strong>Code:</strong> 200 &lt;br /&gt;<br>
        <strong>Content:</strong> <code>{ &quot;success&quot;: true, &quot;result&quot;: &quot;nameProvided&quot;}</code></li>
        </ul>
        </li>
        <li>
        <p><strong>Error Response:</strong></p>
        <ul>
        <li>
        <p><strong>Code:</strong> 422 Unprocessable Entity</p>
        </li>
        <li>
        <p><strong>Error Messages</strong>:</p>
        <p>“Path <code>nombre</code> is required.”: “Name field is required”,<br>
        “Path <code>password</code> is required.”: “Password field is required.”,<br>
        “Path <code>email</code> is required.”: “Email field is required.”,</p>
        </li>
        </ul>
        </li>
        </ul>
        <h4><a id="Login_151"></a>Login</h4>
        <p>** Security **<br>
        Passwords are hashed before being stored into the database using bcrypt module. Security may be increased changing the BCRYPT_SALT_ROUNDS value on .env file, by default is 10.</p>
        <p><strong>URL</strong></p>
        <p><code>http://[server_domain]/apiv1/usuarios/login</code></p>
        <p><strong>Method</strong></p>
        <p>| <code>POST</code> | application/x-www-form-urlencoded</p>
        <p>Values must be provided for the following keys:</p>
        <pre><code>email
        password
        </code></pre>
        <ul>
        <li>
        <p><strong>Success Response:</strong></p>
        <ul>
        <li><strong>Code:</strong> 200 &lt;br /&gt;<br>
        <strong>Content:</strong> <code>{&quot;success&quot;: true, &quot;result&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNWMxYmQ4NzM1ZjVhMzYwOTlmYmIwMWY5IiwiaWF0IjoxNTQ1MzI5MDUwLCJleHAiOjE1NDU1MDE4NTB9.zwjwo3e1MLkX4y6q04N3KaBFXG9m9sbBYJZ-gFuobT8&quot;}</code></li>
        </ul>
        </li>
        <li>
        <p><strong>Error Response:</strong></p>
        <ul>
        <li>
        <p><strong>Code:</strong> 401 UNAUTHORIZED &lt;br /&gt;</p>
        </li>
        <li>
        <p><strong>Error Messages</strong></p>
        <ul>
        <li>
        <p>No password provided</p>
        </li>
        <li>
        <p>No email provided</p>
        </li>
        </ul>
        </li>
        </ul>
        </li>
        </ul>
        <h3><a id="ADS_186"></a>ADS</h3>
        <p>A list of ads will provided</p>
        <ul>
        <li>
        <p><strong>URL</strong></p>
        <p><code>http://[server_domain]/apiv1/anuncios</code></p>
        </li>
        <li>
        <p><strong>Method:</strong></p>
        <p>| <code>GET</code> |</p>
        </li>
        <li>
        <p><strong>URL Params</strong></p>
        <p><strong>Query filters</strong></p>
        <ul>
        <li>
        <p><strong>tag</strong>: Actual valid tags are: <em>mobile</em>, <em>lifestyle</em>, <em>work</em> and <em>motor</em></p>
        <pre><code>http://[server_address]/apiv1/anuncios?tag=mobile... 
        </code></pre>
        </li>
        <li>
        <p><strong>venta</strong>: = A boolean value, <em>true</em> means for sale <em>false</em> means offer</p>
        <pre><code>http://[server_address]/apiv1/anuncios?venta=true... 
        </code></pre>
        </li>
        <li>
        <p><strong>precio</strong>: = Numeric value. Price can be expressed as <em>lower than</em>, a <em>range</em>, or <em>higher than</em>.</p>
        <ul>
        <li>Menor que 50:</li>
        </ul>
        <pre><code>http://[server_address]/apiv1/anuncios?precio=-50... 
        </code></pre>
        <ul>
        <li>Rango:</li>
        </ul>
        <pre><code>http://[server_address]/apiv1/anuncios?precio=10-50... 
        </code></pre>
        <ul>
        <li>Mayor que 50:</li>
        </ul>
        <pre><code>http://[server_address]/apiv1/anuncios?precio=50-... 
        </code></pre>
        </li>
        <li>
        <p><strong>nombre</strong>: = The starting letters of the name of the article;</p>
        <p>Name starts with: <em>Bicl</em></p>
        <pre><code>http://[server_address]/apiv1/anuncios?nombre=Bicl... 
        </code></pre>
        </li>
        </ul>
        <p><strong>Query modifies</strong></p>
        <ul>
        <li><strong>sort</strong>: Sorts the query</li>
        <li><strong>limit</strong>: Limts the number of results</li>
        <li><strong>skip</strong>: Offsets the query results</li>
        </ul>
        </li>
        </ul>
        <p><strong>Token Required:</strong></p>
        <p>A valid <code>jwttoken</code> param is mandatory to get a successful response.<br>
        <code>http://[server_address]/apiv1/anuncios?jwttoken=KV1QiLCJhbGciOiJIUzI1NiJ9.eyJfaWQiOiI1...</code></p>
        <p><strong>Complete example</strong><br>
        <code>http://[server_address]/apiv1/anuncios?tag=mobile&amp;venta=false&amp;nombre=Bicl&amp;precio=50­-&amp;skip=0&amp;limit=2&amp;sort=precio&amp;token =eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9[...]eGSHeQfg</code></p>
        <ul>
        <li>
        <p><strong>Success Response:</strong></p>
        <ul>
        <li><strong>Code:</strong> 200 &lt;br /&gt;<br>
        <strong>Content:</strong> <code>{ { &quot;success&quot;: true, &quot;result&quot;: [ { &quot;tags&quot;: [ &quot;lifestyle&quot;, &quot;motor&quot; ], &quot;_id&quot;: &quot;5c1bd769ce767b0978495a8a&quot;, &quot;nombre&quot;: &quot;Patinete eléctrico&quot;, &quot;venta&quot;: false, &quot;precio&quot;: 235, &quot;foto&quot;: &quot;images/anuncios/patinete.jpg&quot;, &quot;__v&quot;: 0 } ] }</code></li>
        </ul>
        </li>
        <li>
        <p><strong>Error Responses:</strong></p>
        <ul>
        <li>
        <p><strong>Code:</strong> 401 UNAUTHORIZED &lt;br /&gt;</p>
        </li>
        <li>
        <p><strong>Error Messages</strong>:</p>
        <ul>
        <li>No token provided</li>
        <li>Invalid Token</li>
        </ul>
        </li>
        <li>
        <p><strong>Code:</strong> 422 Unprocessable Entity</p>
        </li>
        <li>
        <p><strong>Error Messages</strong>:</p>
        <ul>
        <li>“Please fill a valid email address”: “Please fill a valid email address”,</li>
        <li>“Incorrect format for parameter precio”: “Incorrect format for parameter: precio”</li>
        </ul>
        </li>
        </ul>
        </li>
        </ul>
        <h3><a id="TAGS_288"></a>TAGS</h3>
        <p>A list of distinct tags on database</p>
        <p><strong>URL</strong></p>
        <p><code>http://[server_domain]/apiv1/anuncios/tags</code></p>
        <p><strong>Method</strong></p>
        <p>| <code>TAGS</code> |</p>
        <pre><code>{
            &quot;success&quot;: true,
            &quot;result&quot;: [
                &quot;lifestyle&quot;,
                &quot;mobile&quot;,
                &quot;motor&quot;,
                &quot;work&quot;
            ]
        }
        </code></pre>
        <h3><a id="TRANSLATIONS_311"></a>TRANSLATIONS</h3>
        <p>The API has an i18n module for internationalization.<br>
        It has translated error messages to english an spanish</p>
        <p>The language is detected by the header <em>Accept-Language</em> key</p>
        <pre><code>en: english
        es: spanish
        </code></pre>
      </section>

    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/resume.min.js"></script>

  </body>

</html>
